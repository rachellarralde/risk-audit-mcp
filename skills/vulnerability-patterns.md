# Vulnerability Detection Patterns

Quick reference for security pattern matching. Use with grep/ripgrep for automated scanning.

---

## Critical Severity

### SQL Injection

| ID | Language | Pattern | Description |
|----|----------|---------|-------------|
| VBC100 | JS/TS | `\.query\s*\(\s*[^\)]*\+[^\)]*\)` | String concatenation in .query() |
| VBP110 | Python | `\.execute\s*\(\s*(?:f['"].*\{.*\}.*['"]|['"].*\.format\(|['"].*%)` | f-string/format/% in cursor.execute() |

### Command Injection

| ID | Language | Pattern | Description |
|----|----------|---------|-------------|
| VBC250 | JS/TS | `\b(?:child_process\.)?exec\s*\(\s*[^\)]*\+[^\)]*\)` | Concatenation in exec() |
| VBC200 | Python | `\bos\.system\s*\(\s*[^\)]*(?:\+\|[^'"\)]\w)` | Variable in os.system() |
| VBC201 | Python | `\bsubprocess\.(?:run\|Popen\|call\|check_output)\s*\([^\)]*shell\s*=\s*True` | shell=True in subprocess |

---

## Medium Severity

### XSS

| ID | Language | Pattern | Description |
|----|----------|---------|-------------|
| VBC001 | JS/TS | `\b(?:innerHTML\|outerHTML)\s*=\s*(?!['"]).+` | Non-literal innerHTML assignment |
| VBC002 | React | `dangerouslySetInnerHTML\s*=\s*\{\s*\{\s*__html\s*:` | dangerouslySetInnerHTML usage |
| YAML100 | JS/TS | `\bdocument\.write\s*\(` | document.write() usage |

### SSRF

| ID | Language | Pattern | Description |
|----|----------|---------|-------------|
| VBC150 | JS/TS | `\b(?:fetch\|axios\.(?:get\|post\|put\|delete\|request))\s*\(\s*(?!['"]).` | Variable URL in fetch/axios |

### Path Traversal

| ID | Language | Pattern | Description |
|----|----------|---------|-------------|
| VBC260 | JS/TS | `\bfs\.(?:readFile\|readFileSync\|writeFile\|createReadStream\|unlink\|existsSync\|mkdir\|rmdir)\s*\(\s*(?!['"]).` | Non-literal path in fs.* |
| VBC300 | Python | `\bopen\s*\(\s*(?!['"]).` | Non-literal path in open() |

### NoSQL Injection

| ID | Language | Pattern | Description |
|----|----------|---------|-------------|
| VBC450 | JS/TS | `\.(?:find\|findOne\|updateOne\|updateMany\|deleteMany\|aggregate)\s*\(\s*(?!\{\|\[\|['"])` | Variable object in Mongo query |

---

## Low Severity

### Template Injection

| ID | Language | Pattern | Description |
|----|----------|---------|-------------|
| VBP310 | Python | `\brender_template_string\s*\(\s*(?!['"]).` | Variable in render_template_string() |

### Debug Code

| ID | Language | Pattern | Description |
|----|----------|---------|-------------|
| YAML001 | JS | `\balert\s*\(` | alert() usage |

---

## Taint Sources (Untrusted Input)

### JavaScript/TypeScript
```regex
req\.(?:query|params|body)\b
window\.location\b
document\.location\b
location\.(?:hash|search|href)\b
document\.cookie\b
localStorage\b
sessionStorage\b
```

### Python
```regex
request\.(?:args|form|data|json|values|get_json)\b
os\.environ\b
sys\.argv\b
```

---

## Usage Examples

### Grep for SQL Injection (JS/TS)
```bash
rg -n "\.query\s*\(\s*[^\)]*\+[^\)]*\)" --type ts --type js
```

### Grep for Command Injection (Python)
```bash
rg -n "subprocess\..*shell\s*=\s*True" --type py
```

### Grep for XSS
```bash
rg -n "innerHTML\s*=" --type js --type ts
```

### Grep for All Taint Sources (JS)
```bash
rg -n "req\.(query|params|body)" --type js --type ts
```

---

## Severity Guidelines

| Severity | Impact | Examples |
|----------|--------|----------|
| **Critical** | Remote code execution, full database access, complete system compromise | SQL injection, Command injection |
| **Medium** | Data theft, session hijacking, unauthorized actions | XSS, SSRF, CSRF, Path traversal (read) |
| **Low** | Information disclosure, minor security weakening | Debug info exposure, Missing headers |
